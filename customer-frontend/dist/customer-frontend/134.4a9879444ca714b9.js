"use strict";(self.webpackChunkcustomer_frontend=self.webpackChunkcustomer_frontend||[]).push([[134],{9134:(j,g,o)=>{o.r(g),o.d(g,{StoreModule:()=>O});var l=o(9808),m=o(4521),x=o(7579),T=o(8372),d=o(3075),y=o(2722),t=o(5e3),v=o(520),P=o(4004),F=o(7489),U=o(629),f=o(7261),L=o(9281),J=o(1303);let S=(()=>{class r{constructor(e,a,n,i,u,p){this.httpClient=e,this.authService=a,this.matSnackBar=n,this.router=i,this.customerService=u,this.storageService=p}getProducts(e){const a=(new v.LE).append("name",e||"");return this.httpClient.get("package",{params:a}).pipe((0,P.U)(n=>{if(!this.authService.isLoggedIn())return n;const i=this.customerService.getPurchases();for(const u of n){u.isAlreadyPurchased=!1;for(const p of i)u.id===p.id&&(u.isAlreadyPurchased=!0)}return n}))}purchaseProduct(e){if(this.authService.isLoggedIn()){const{id:a,purchases:n}=this.storageService.get("auth")||{};if(!a||!n)return;this.httpClient.patch(`customer/purchase/${a}`,F.map([...n,e],"id")).subscribe(i=>{this.storageService.update({key:"auth",value:i})})}else this.matSnackBar.open("Please log in first","Dismiss",{duration:3e3}),this.router.navigate(["/auth"])}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(v.eN),t.LFG(U.e),t.LFG(f.ux),t.LFG(m.F0),t.LFG(L.v),t.LFG(J.V))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac}),r})();var h=o(7322),Z=o(7531),A=o(3874),c=o(9224),C=o(7423);function M(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"mat-card",7),t.TgZ(1,"mat-card-header"),t._UZ(2,"div",8),t.TgZ(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.ALo(7,"number"),t.TgZ(8,"span",9),t._uU(9,"available"),t.qZA(),t.qZA(),t.qZA(),t._UZ(10,"img",10),t.TgZ(11,"mat-card-content"),t.TgZ(12,"p"),t._uU(13),t.qZA(),t.qZA(),t.TgZ(14,"mat-card-actions"),t.TgZ(15,"div",11),t.TgZ(16,"button",12),t.NdJ("click",function(){const i=t.CHM(e).$implicit;return t.oxw().purchase(i)}),t._uU(17),t.TgZ(18,"mat-icon"),t._uU(19,"sell"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&r){const e=s.$implicit;t.xp6(4),t.Oqu(e.name),t.xp6(2),t.hij("",t.lcZ(7,7,e.price)," $ "),t.xp6(4),t.Q6J("src",e.imageUrl,t.LSH)("alt",e.name),t.xp6(3),t.Oqu(e.description),t.xp6(3),t.Q6J("disabled",e.isAlreadyPurchased),t.xp6(1),t.hij("",e.isAlreadyPurchased?"Purchased":"Add to Cart"," ")}}const $=[{path:"",component:(()=>{class r{constructor(e){this.storeService=e,this.searchControl=new d.NI(""),this.products$=this.storeService.getProducts(),this.unsubscribeAll=new x.x}ngOnInit(){this.onSearchChange()}onSearchChange(){this.searchControl.valueChanges.pipe((0,T.b)(400),(0,y.R)(this.unsubscribeAll)).subscribe(e=>{this.products$=this.storeService.getProducts(e)})}purchase(e){this.storeService.purchaseProduct(e),this.products$=this.storeService.getProducts()}ngOnDestroy(){this.unsubscribeAll.complete()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(S))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-store"]],decls:11,vars:4,consts:[[1,"p-5"],[1,"w-full","sm:w-auto","mb-5"],["appearance","outline",1,"w-full"],["matInput","","type","text",3,"formControl"],["matSuffix",""],[1,"flex","flex-wrap","gap-5"],["class","product",4,"ngFor","ngForOf"],[1,"product"],["mat-card-avatar","",1,"bg-green-400"],[1,"text-green-400"],["mat-card-image","",3,"src","alt"],[1,"flex","gap-1"],["mat-flat-button","","color","accent",3,"disabled","click"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"mat-form-field",2),t.TgZ(3,"mat-label"),t._uU(4,"Search"),t.qZA(),t._UZ(5,"input",3),t.TgZ(6,"mat-icon",4),t._uU(7,"search"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"div",5),t.YNc(9,M,20,9,"mat-card",6),t.ALo(10,"async"),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("formControl",a.searchControl),t.xp6(4),t.Q6J("ngForOf",t.lcZ(10,2,a.products$)))},directives:[h.KE,h.hX,Z.Nt,d.Fj,d.JJ,d.oH,A.Hw,h.R9,l.sg,c.a8,c.dk,c.kc,c.n5,c.$j,c.G2,c.dn,c.hq,C.lW],pipes:[l.Ov,l.JJ],styles:[".product[_ngcontent-%COMP%]{max-width:500px}"]}),r})()}];let b=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[m.Bz.forChild($)],m.Bz]}),r})(),O=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[S],imports:[[l.ez,b,c.QW,C.ot,A.Ps,h.lN,Z.c,d.UX,f.ZX]]}),r})()}}]);