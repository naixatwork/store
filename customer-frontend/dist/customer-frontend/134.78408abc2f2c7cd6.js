"use strict";(self.webpackChunkcustomer_frontend=self.webpackChunkcustomer_frontend||[]).push([[134],{9134:(J,p,o)=>{o.r(p),o.d(p,{StoreModule:()=>j});var d=o(9808),h=o(4521),C=o(7579),x=o(8372),g=o(3075),T=o(2722),t=o(5e3),v=o(520),P=o(1135),y=o(4004),F=o(629),l=o(7261),U=o(9281),S=o(1303);let f=(()=>{class r{constructor(e,c,n,i,u,m){this.httpClient=e,this.authService=c,this.matSnackBar=n,this.router=i,this.customerService=u,this.storageService=m,this.cart$=new P.X(this.storageService.get("cart")||[]),this.cart$.subscribe(G=>{this.storageService.update({key:"cart",value:G})})}getProducts(e){const c=(new v.LE).append("name",e||"");return this.httpClient.get("Product",{params:c}).pipe((0,y.U)(n=>{if(!this.authService.isLoggedIn())return n;const i=this.customerService.getPurchases();for(const u of n){u.isAlreadyPurchased=!1;for(const m of i)u.id===m.id&&(u.isAlreadyPurchased=!0)}return n}))}purchaseProduct(e){this.storageService.get("auth")?(u=>{this.cart$.next([...this.cart$.value,e])})():(()=>{this.router.navigate(["/auth"]),this.matSnackBar.open("Please complete the authentication process","Dismiss")})()}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(v.eN),t.LFG(F.e),t.LFG(l.ux),t.LFG(h.F0),t.LFG(U.v),t.LFG(S.V))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var a=o(9224),Z=o(7423),A=o(3874);function L(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"mat-card",3),t.TgZ(1,"mat-card-header"),t._UZ(2,"div",4),t.TgZ(3,"mat-card-title",5),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.ALo(7,"number"),t.TgZ(8,"span",6),t._uU(9,"available"),t.qZA(),t.qZA(),t.qZA(),t._UZ(10,"img",7),t.TgZ(11,"mat-card-content"),t.TgZ(12,"p",5),t._uU(13),t.qZA(),t.qZA(),t.TgZ(14,"mat-card-actions"),t.TgZ(15,"div",8),t.TgZ(16,"button",9),t.NdJ("click",function(){const i=t.CHM(e).$implicit;return t.oxw().purchase(i)}),t._uU(17),t.TgZ(18,"mat-icon"),t._uU(19,"sell"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&r){const e=s.$implicit;t.xp6(4),t.Oqu(e.name),t.xp6(2),t.hij("",t.lcZ(7,6,e.price)," $ "),t.xp6(4),t.Q6J("src",e.imageUrl,t.LSH)("alt",e.name),t.xp6(3),t.Oqu(e.description),t.xp6(4),t.hij("",e.isAlreadyPurchased?"Purchased":"Add to Cart"," ")}}const M=[{path:"",component:(()=>{class r{constructor(e,c,n){this.storeService=e,this.storageService=c,this.matSnackBar=n,this.searchControl=new g.NI(""),this.products$=this.storeService.getProducts(),this.unsubscribeAll=new C.x}ngOnInit(){this.onSearchChange()}onSearchChange(){this.searchControl.valueChanges.pipe((0,x.b)(400),(0,T.R)(this.unsubscribeAll)).subscribe(e=>{this.products$=this.storeService.getProducts(e)})}purchase(e){this.storeService.purchaseProduct(e),this.matSnackBar.open("Item has been added to your cart list","Dismiss")}ngOnDestroy(){this.unsubscribeAll.complete()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(f),t.Y36(S.V),t.Y36(l.ux))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-store"]],decls:4,vars:3,consts:[[1,"p-5"],[1,"product-container"],["class","product",4,"ngFor","ngForOf"],[1,"product"],["mat-card-avatar","",1,"bg-green-400"],[2,"text-align","right"],[1,"text-green-400"],["mat-card-image","",1,"product-image",3,"src","alt"],[1,"flex","gap-1"],["mat-flat-button","","color","accent",3,"click"]],template:function(e,c){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.YNc(2,L,20,8,"mat-card",2),t.ALo(3,"async"),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.lcZ(3,1,c.products$)))},directives:[d.sg,a.a8,a.dk,a.kc,a.n5,a.$j,a.G2,a.dn,a.hq,Z.lW,A.Hw],pipes:[d.Ov,d.JJ],styles:[".product-container[_ngcontent-%COMP%]{display:grid;grid-gap:15px;gap:15px;grid-template-columns:repeat(5,1fr)}.product[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{max-height:300px;max-width:100%}"]}),r})()}];let $=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[h.Bz.forChild(M)],h.Bz]}),r})();var O=o(7322),B=o(7531);let j=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[f],imports:[[d.ez,$,a.QW,Z.ot,A.Ps,O.lN,B.c,g.UX,l.ZX]]}),r})()}}]);